THREE.OrbitControls=function(C,D){function E(b){if(!1!==a.enabled){b.preventDefault();var c=a.domElement===document?a.domElement.body:a.domElement;if(e===d.ROTATE){if(!0===a.noRotate)return;k.set(b.clientX,b.clientY);l.subVectors(k,m);a.rotateLeft(2*Math.PI*l.x/c.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*l.y/c.clientHeight*a.rotateSpeed);m.copy(k)}else if(e===d.DOLLY){if(!0===a.noZoom)return;n.set(b.clientX,b.clientY);w.subVectors(n,p);0<w.y?a.dollyIn():a.dollyOut();p.copy(n)}else if(e===d.PAN){if(!0===
a.noPan)return;q.set(b.clientX,b.clientY);r.subVectors(q,t);a.pan(r.x,r.y);t.copy(q)}e!==d.NONE&&a.update()}}function F(){!1!==a.enabled&&(document.removeEventListener("mousemove",E,!1),document.removeEventListener("mouseup",F,!1),a.dispatchEvent(A),e=d.NONE)}function G(b){if(!1!==a.enabled&&!0!==a.noZoom&&e===d.NONE){b.preventDefault();b.stopPropagation();var c=0;void 0!==b.wheelDelta?c=b.wheelDelta:void 0!==b.detail&&(c=-b.detail);0<c?a.dollyOut():a.dollyIn();a.update();a.dispatchEvent(B);a.dispatchEvent(A)}}
this.object=C;this.domElement=void 0!==D?D:document;this.enabled=!0;this.center=this.target=new THREE.Vector3;this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.noRotate=!1;this.rotateSpeed=1;this.noPan=!1;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,
ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT};var a=this,m=new THREE.Vector2,k=new THREE.Vector2,l=new THREE.Vector2,t=new THREE.Vector2,q=new THREE.Vector2,r=new THREE.Vector2,u=new THREE.Vector3,f=new THREE.Vector3,p=new THREE.Vector2,n=new THREE.Vector2,w=new THREE.Vector2,h,g,x=0,y=0,v=1,z=new THREE.Vector3,H=new THREE.Vector3,I=new THREE.Quaternion,d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},e=d.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();
var J=(new THREE.Quaternion).setFromUnitVectors(C.up,new THREE.Vector3(0,1,0)),K=J.clone().inverse(),L={type:"change"},B={type:"start"},A={type:"end"};this.rotateLeft=function(b){void 0===b&&(b=2*Math.PI/60/60*a.autoRotateSpeed);y-=b};this.rotateUp=function(b){void 0===b&&(b=2*Math.PI/60/60*a.autoRotateSpeed);x-=b};this.panLeft=function(a){var c=this.object.matrix.elements;u.set(c[0],c[1],c[2]);u.multiplyScalar(-a);z.add(u)};this.panUp=function(a){var c=this.object.matrix.elements;u.set(c[4],c[5],
c[6]);u.multiplyScalar(a);z.add(u)};this.pan=function(b,c){var d=a.domElement===document?a.domElement.body:a.domElement;if(void 0!==a.object.fov){var e=a.object.position.clone().sub(a.target).length(),e=e*Math.tan(a.object.fov/2*Math.PI/180);a.panLeft(2*b*e/d.clientHeight);a.panUp(2*c*e/d.clientHeight)}else void 0!==a.object.top?(a.panLeft(b*(a.object.right-a.object.left)/d.clientWidth),a.panUp(c*(a.object.top-a.object.bottom)/d.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};
this.dollyIn=function(b){void 0===b&&(b=Math.pow(.95,a.zoomSpeed));v/=b};this.dollyOut=function(b){void 0===b&&(b=Math.pow(.95,a.zoomSpeed));v*=b};this.update=function(){var b=this.object.position;f.copy(b).sub(this.target);f.applyQuaternion(J);h=Math.atan2(f.x,f.z);g=Math.atan2(Math.sqrt(f.x*f.x+f.z*f.z),f.y);this.autoRotate&&e===d.NONE&&this.rotateLeft(2*Math.PI/60/60*a.autoRotateSpeed);h+=y;g+=x;h=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,h));g=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,
g));g=Math.max(1E-6,Math.min(Math.PI-1E-6,g));var c=f.length()*v,c=Math.max(this.minDistance,Math.min(this.maxDistance,c));this.target.add(z);f.x=c*Math.sin(g)*Math.sin(h);f.y=c*Math.cos(g);f.z=c*Math.sin(g)*Math.cos(h);f.applyQuaternion(K);b.copy(this.target).add(f);this.object.lookAt(this.target);x=y=0;v=1;z.set(0,0,0);if(1E-6<H.distanceToSquared(this.object.position)||1E-6<8*(1-I.dot(this.object.quaternion)))this.dispatchEvent(L),H.copy(this.object.position),I.copy(this.object.quaternion)};this.reset=
function(){e=d.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);this.update()};this.getPolarAngle=function(){return g};this.getAzimuthalAngle=function(){return h};this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1);this.domElement.addEventListener("mousedown",function(b){if(!1!==a.enabled){b.preventDefault();if(b.button===a.mouseButtons.ORBIT){if(!0===a.noRotate)return;e=d.ROTATE;m.set(b.clientX,b.clientY)}else if(b.button===a.mouseButtons.ZOOM){if(!0===
a.noZoom)return;e=d.DOLLY;p.set(b.clientX,b.clientY)}else if(b.button===a.mouseButtons.PAN){if(!0===a.noPan)return;e=d.PAN;t.set(b.clientX,b.clientY)}e!==d.NONE&&(document.addEventListener("mousemove",E,!1),document.addEventListener("mouseup",F,!1),a.dispatchEvent(B))}},!1);this.domElement.addEventListener("mousewheel",G,!1);this.domElement.addEventListener("DOMMouseScroll",G,!1);this.domElement.addEventListener("touchstart",function(b){if(!1!==a.enabled){switch(b.touches.length){case 1:if(!0===a.noRotate)return;
e=d.TOUCH_ROTATE;m.set(b.touches[0].pageX,b.touches[0].pageY);break;case 2:if(!0===a.noZoom)return;e=d.TOUCH_DOLLY;var c=b.touches[0].pageX-b.touches[1].pageX;b=b.touches[0].pageY-b.touches[1].pageY;c=Math.sqrt(c*c+b*b);p.set(0,c);break;case 3:if(!0===a.noPan)return;e=d.TOUCH_PAN;t.set(b.touches[0].pageX,b.touches[0].pageY);break;default:e=d.NONE}e!==d.NONE&&a.dispatchEvent(B)}},!1);this.domElement.addEventListener("touchend",function(){!1!==a.enabled&&(a.dispatchEvent(A),e=d.NONE)},!1);this.domElement.addEventListener("touchmove",
function(b){if(!1!==a.enabled){b.preventDefault();b.stopPropagation();var c=a.domElement===document?a.domElement.body:a.domElement;switch(b.touches.length){case 1:if(!0===a.noRotate)break;if(e!==d.TOUCH_ROTATE)break;k.set(b.touches[0].pageX,b.touches[0].pageY);l.subVectors(k,m);a.rotateLeft(2*Math.PI*l.x/c.clientWidth*a.rotateSpeed);a.rotateUp(2*Math.PI*l.y/c.clientHeight*a.rotateSpeed);m.copy(k);a.update();break;case 2:if(!0===a.noZoom)break;if(e!==d.TOUCH_DOLLY)break;c=b.touches[0].pageX-b.touches[1].pageX;
b=b.touches[0].pageY-b.touches[1].pageY;b=Math.sqrt(c*c+b*b);n.set(0,b);w.subVectors(n,p);0<w.y?a.dollyOut():a.dollyIn();p.copy(n);a.update();break;case 3:if(!0===a.noPan)break;if(e!==d.TOUCH_PAN)break;q.set(b.touches[0].pageX,b.touches[0].pageY);r.subVectors(q,t);a.pan(r.x,r.y);t.copy(q);a.update();break;default:e=d.NONE}}},!1);window.addEventListener("keydown",function(b){if(!1!==a.enabled&&!0!==a.noKeys&&!0!==a.noPan)switch(b.keyCode){case a.keys.UP:a.pan(0,a.keyPanSpeed);a.update();break;case a.keys.BOTTOM:a.pan(0,
-a.keyPanSpeed);a.update();break;case a.keys.LEFT:a.pan(a.keyPanSpeed,0);a.update();break;case a.keys.RIGHT:a.pan(-a.keyPanSpeed,0),a.update()}},!1);this.update()};THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);THREE.OrbitControls.prototype.constructor=THREE.OrbitControls;